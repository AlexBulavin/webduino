<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script></head><body><script>const delay=(seconds)=>{return new Promise((resolve)=>{setTimeout(resolve,seconds*1000);});};const main=async()=>{
var _E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80, _E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC, _E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1, SQL, _E8_A9_A6_E7_AE_97_E8_A1_A8ID, _E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC, _E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E, arr, c, i, j;

// 描述此函式...
function _E6_9F_A5_E8_A9_A2(_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC, _E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1, SQL) {
  _E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC = _E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC;
  spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,_E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1);
  spreadsheetsql_executeSql(SQL);
}


_E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80 = 'https://docs.google.com/spreadsheets/d/1RMRpUm-yjrrMwKthU4bZJN1wYdSawnjK-GDYuFzCIzw/edit?usp=sharing';
_E8_A9_A6_E7_AE_97_E8_A1_A8ID = '1RMRpUm-yjrrMwKthU4bZJN1wYdSawnjK-GDYuFzCIzw';
_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E = [];
spreadsheetsql_getDataFinish = function() {
  if (_E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC == 'add') {
    if ((spreadsheetsql_getDataCount("ROWS")) == 0) {
      var windowConfirm = window.confirm((['你確定要新增 [ ',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));
      if (windowConfirm==true) {
          spreadsheet_insert("insertfirst", String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[0])+"|"+String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[1])+"|"+String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2])+"|"+String("gmt_datetime"), 0, 0, "", _E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80, '簽到', "https://script.google.com/macros/s/AKfycbxA3hhTlntwVTOcqngOC_iJL_zLmRwzcDbMYDs7FD8iinNsY9XZsMkD7AcXTIUbEc33EA/exec");
        alert((['已新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));

      }
      else {
          alert((['已取消新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));

      }
    } else {
      alert((['已存在無法新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));
    }
  } else if (_E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC != '') {
    var arr = [['', '']];
    var i_end = (spreadsheetsql_getDataCount("ROWS"));
    var i_inc = 1;
    if (1 > i_end) {
      i_inc = -i_inc;
    }
    for (i = 1; i_inc >= 0 ? i <= i_end : i >= i_end; i += i_inc) {
      if ((spreadsheetsql_getCell(1, i)) != null) {
        arr.push([spreadsheetsql_getCell(1, i), spreadsheetsql_getCell(1, i)]);
      }
    }
    select_set(_E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC,"option",arr);
    _E6_8C_87_E4_BB_A4_E4_BE_86_E6_BA_90_E4_BB_A3_E7_A2_BC = '';
  } else {
    spreadsheetsql_getDataTable('',600,20,0,150,false);
    table_change_colsrows('',"col","add",4);
    select_set('type',"value",'');
    select_set('unit',"value",'');
    var j_end = (spreadsheetsql_getDataCount("ROWS"));
    var j_inc = 1;
    if (1 > j_end) {
      j_inc = -j_inc;
    }
    for (j = 1; j_inc >= 0 ? j <= j_end : j >= j_end; j += j_inc) {
      table_td_insert_text('',4,(j - 1),'&#x2611;','Arial',12,'#33cc00');
    }
  }

};
setInterval(async function(){
  var c = (table_get('',"onclick[Column,Row]"));
  if (c[0] == 4) {
    _E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E = [table_td_get('',1,(c[1]),"innerHTML"), table_td_get('',2,(c[1]),"innerHTML"), table_td_get('',3,(c[1]),"innerHTML")];
    _E6_9F_A5_E8_A9_A2('add', '簽到', ['select * where A=\'',table_td_get('',1,(c[1]),"innerHTML"),'\' and B=\'',table_td_get('',2,(c[1]),"innerHTML"),'\' and C=\'',table_td_get('',3,(c[1]),"innerHTML"),'\''].join(''));
  }
},10);
span_create('type',0,10,30,'查詢類別',999);
select_create('type',200,50,140,10,'#ffffff','#000000',30,1,[],'',999,true);
async function gameselect_type_onchange (event) {
  _E6_9F_A5_E8_A9_A2('', '名單', ['select A,C,D,E where B=\'',select_get('type',"selectedValue"),'\''].join(''));
};
document.getElementById("gameselect_type").addEventListener("change", gameselect_type_onchange, true);
span_create('unit',360,10,30,'查詢單位',999);
select_create('unit',200,50,500,10,'#ffffff','#000000',30,1,[],'',999,true);
async function gameselect_unit_onchange (event) {
  _E6_9F_A5_E8_A9_A2('', '名單', ['select A,C,D,E where C=\'',select_get('unit',"selectedValue"),'\''].join(''));
};
document.getElementById("gameselect_unit").addEventListener("change", gameselect_unit_onchange, true);
span_create('keyword',0,70,30,'關鍵字',999);
text_create('keyword',200,50,140,70,'#ffffff','#000000',30,1,'',999,true);
button_create('keyword',100,50,360,70,1,null,'查詢',30,999,true);
async function gamebutton_keyword_onclick (event) {
  _E6_9F_A5_E8_A9_A2('', '名單', ['select A,C,D,E where C like \'%',text_get('keyword',"value"),'%\' or D like \'%',text_get('keyword',"value"),'%\' or E like \'%',text_get('keyword',"value"),'%\''].join(''));
};
document.getElementById("gamebutton_keyword").addEventListener("click", gamebutton_keyword_onclick, true);
_E6_9F_A5_E8_A9_A2('type', '選單', 'select A');
await delay(4);
_E6_9F_A5_E8_A9_A2('unit', '選單', 'select B');
iframe_create('',700,700,800,10,"0","yes",'https://docs.google.com/spreadsheets/d/1RMRpUm-yjrrMwKthU4bZJN1wYdSawnjK-GDYuFzCIzw/edit#gid=1028010972','',1,999,true);
};main();</script></body></html>